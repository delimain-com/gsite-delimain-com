@if ($isReady()) {
	<div class="card h-100 rounded-0">
		<div class="card-header p-1">
			<strong>イベント一覧</strong>
		</div>
		<div class="card-body p-1 h-100">
			<div class="d-flex flex-column gap-1">
				<div class="card">
					<div class="card-header p-0 px-1">
						<span>検索</span>
					</div>
					<div class="card-body p-1">
						<div class="d-flex flex-row gap-1">
							<div class="input-group input-group-sm w-auto">
								<div class="input-group-text">タイトル</div>
								<input class="form-control-sm form-control"
								       type="text"
								       [ngModel]="$q_title()"
								       (ngModelChange)="$q_title.set($event);action_load_eventList();"/>
							</div>
							<div class="input-group input-group-sm w-auto">
								<div class="input-group-text">表示件数</div>
								<select class="form-select form-select-sm"
								        [ngModel]="$q_limit()"
								        (ngModelChange)="$q_limit.set($event);action_load_eventList();">
									@for (limit of [1, 5, 10, 30, 50, 100, 500, 100]; track limit) {
										<option [ngValue]="limit"
										        [textContent]="limit |number"></option>
									}
								</select>
							</div>
							<div class="input-group input-group-sm w-auto">
								<div class="input-group-text">ページ</div>
								<input class="form-control form-control-sm"
								       type="number"
								       [min]="1"
								       [ngModel]="$q_page()"
								       (ngModelChange)="$q_page.set($event);action_load_eventList();"
								       (wheel)="util.noop();"
								       style="width:4rem;"/>
							</div>
						</div>
					</div>
				</div>
				<div class="card">
					<div class="card-header p-0 px-1">
						<div class="d-flex justify-content-between px-1">
							<div>
								<span>一覧</span>
								@let eventListCount = $eventListCount();
								@if (util.isNumber(eventListCount)) {
									<span class="label-count mx-1"
									      [textContent]="$eventListCount()"></span>
								}
							</div>
							<div>
								<i class="fa fa-refresh fa-hover cursor-pointer"
								   [class.fa-spin]="$load_eventList_isWait()"
								   (click)="action_load_eventList();"></i>
							</div>
						</div>
					</div>
					@if ($eventList(); as eventList) {
						<div class="card-body p-1">
							<table class="table table-sm table-striped table-hover table-bordered event-list-table">
								<thead>
									<tr class="table-warning">
										<th>タイトル</th>
										<th>操作</th>
									</tr>
								</thead>
								<tbody>
									@for (event of eventList; track event.uid) {
										<tr>
											<td>
												<a routerLink="/eventEdit"
												   [queryParams]="{uid:event.uid,domain:siteInfo.$domain()}"
												   [textContent]="event.title"></a>
											</td>
											<td>
												<div class="d-flex flex-row gap-1 justify-content-center">
													<button class="btn btn-sm border"
													        [class.btn-success]="event.viewFlag"
													        (click)="action_event_viewFlag(event);"
													        [textContent]="event.viewFlag?'表示中':'非表示'"></button>
													<button class="btn btn-danger btn-sm"
													        (click)="action_remove_event(event);">
														削除
													</button>
												</div>
											</td>
										</tr>
									}
								</tbody>
							</table>
						</div>
					}
				</div>
			</div>
		</div>
	</div>
} @else {
	<div>loading...</div>
}