import{a as J}from"./chunk-GUTABKTZ.js";import{b as X,c as Y,f as Z,h as ee,i as te,j as ie,k as ne,l as oe,n as ae,p as re}from"./chunk-MZI3TSC7.js";import{a as H}from"./chunk-AK7IFNAC.js";import{A as G,C as K,e as U,l as Q,p as z,x as p}from"./chunk-QS74EYGS.js";import{$b as T,Eb as w,I as u,Ib as b,Jb as d,R as y,Sb as S,T as v,Ta as l,Tb as c,Zb as R,_b as A,a as F,b as V,ba as m,db as W,dc as P,fc as B,gc as I,ha as _,hc as E,ia as g,j as q,la as N,lc as O,pb as h,qb as x,sa as f,sb as k,tb as $,tc as j,ub as M,vb as C,wb as a,xb as o,yb as L}from"./chunk-J3CZU5IE.js";var se=()=>[1,5,10,30,50,100,500,100],le=(i,t)=>({uid:i,domain:t}),de=(i,t)=>t.uid;function ce(i,t){if(i&1&&(L(0,"option",10),I(1,"number")),i&2){let e=t.$implicit;C("ngValue",e)("textContent",E(1,2,e))}}function pe(i,t){if(i&1&&(L(0,"span",13),I(1,"number")),i&2){d();let e=T(32);C("textContent",E(1,1,e))}}function ue(i,t){if(i&1){let e=w();a(0,"tr")(1,"td"),L(2,"a",17),o(),a(3,"td")(4,"div",18)(5,"button",19),b("click",function(){let r=_(e).$implicit,s=d(3);return g(s.action_info_viewFlag(r))}),o(),a(6,"button",20),b("click",function(){let r=_(e).$implicit,s=d(3);return g(s.action_remove_info(r))}),c(7," \u524A\u9664 "),o()()()()}if(i&2){let e=t.$implicit,n=d(3);l(2),C("queryParams",B(5,le,e.uid,n.siteInfo.$domain()))("textContent",e.title),l(3),S("btn-success",e.viewFlag),C("textContent",e.viewFlag?"\u8868\u793A\u4E2D":"\u975E\u8868\u793A")}}function fe(i,t){i&1&&(a(0,"div",2)(1,"table",15)(2,"thead")(3,"tr",16)(4,"th"),c(5,"\u30BF\u30A4\u30C8\u30EB"),o(),a(6,"th"),c(7,"\u64CD\u4F5C"),o()()(),a(8,"tbody"),$(9,ue,8,8,"tr",null,de),o()()()),i&2&&(l(9),M(t))}function me(i,t){if(i&1){let e=w();a(0,"div",0)(1,"div",1)(2,"span"),c(3,"\u65B0\u7740\u4E00\u89A7"),o()(),a(4,"div",2)(5,"div",3)(6,"div",0)(7,"div",4)(8,"span"),c(9,"\u691C\u7D22"),o()(),a(10,"div",2)(11,"div",5)(12,"div",6)(13,"div",7),c(14,"\u30BF\u30A4\u30C8\u30EB"),o(),a(15,"input",8),b("ngModelChange",function(r){_(e);let s=d();return s.$q_title.set(r),g(s.action_load_infoList())}),o()(),a(16,"div",6)(17,"div",7),c(18,"\u8868\u793A\u4EF6\u6570"),o(),a(19,"select",9),b("ngModelChange",function(r){_(e);let s=d();return s.$q_limit.set(r),g(s.action_load_infoList())}),$(20,ce,2,4,"option",10,k),o()(),a(22,"div",6)(23,"div",7),c(24,"\u30DA\u30FC\u30B8"),o(),a(25,"input",11),b("ngModelChange",function(r){_(e);let s=d();return s.$q_page.set(r),g(s.action_load_infoList())})("wheel",function(){_(e);let r=d();return g(r.util.noop())}),o()()()()(),a(26,"div",0)(27,"div",4)(28,"div",12)(29,"div")(30,"span"),c(31,"\u4E00\u89A7"),o(),R(32),h(33,pe,2,3,"span",13),o(),a(34,"div")(35,"i",14),b("click",function(){_(e);let r=d();return g(r.action_load_infoList())}),o()()()(),h(36,fe,11,0,"div",2),o()()()()}if(i&2){let e,n=d();l(15),C("ngModel",n.$q_title()),l(4),C("ngModel",n.$q_limit()),l(),M(P(9,se)),l(5),C("min",1)("ngModel",n.$q_page()),l(7);let r=A(n.$infoListCount());l(),x(n.util.isNumber(r)?33:-1),l(2),S("fa-spin",n.$load_infoList_isWait()),l(),x((e=n.$infoList())?36:-1,e)}}function _e(i,t){i&1&&(a(0,"div"),c(1,"loading..."),o())}var D=class i{#e=m(N);changeDetectorRef=m(j);util=m(K);api=m(G);notifyMessage=m(re);$isReady=f(!1);$queryParams=H();$q_title=f(void 0);$q_page=f(1);$q_limit=f(100);siteInfo=m(J);$params=O(()=>{let t={query:{}};{let e=this.$q_title();e&&(t.query.title=e.trim())}return t});$infoList=f(void 0);$infoListCount=f(void 0);activatedRoute=m(Q);constructor(){this.activatedRoute.queryParams.pipe(p(this.#e),v(()=>this.$isReady.set(!1)),y(()=>this.load()),v(()=>this.$isReady.set(!0)),u(1)).subscribe()}$load_isWait=f(!1);load(){this.$load_isWait.set(!0);let t=this.$params();return this.api.post("page/infoList/load",t).pipe(p(this.#e),v(({results:e})=>{this.$infoList.set(e.infoList||[]),this.$infoListCount.set(e.infoListCount||0),this.$load_isWait.set(!1)}),u(1))}load$=(()=>{let t=new q;return t.pipe(p(this.#e),y(()=>this.load())).subscribe(),t})();action_load(){this.load().pipe(p(this.#e),u(1))}$load_infoList_isWait=f(!1);load_infoList(){this.$load_infoList_isWait.set(!0),this.$infoList.set(void 0),this.$infoListCount.set(void 0);let t=this.$params();return this.api.post("page/infoList/load_infoList",t).pipe(p(this.#e),v(({results:e})=>{this.$infoList.set(e.infoList||[]),this.$infoListCount.set(e.infoList||0),this.$load_infoList_isWait.set(!1)}),u(1))}action_load_infoList(){this.load_infoList().pipe(p(this.#e),u(1)).subscribe()}remove_info(t){let e={info:t};return this.notifyMessage.show("\u524A\u9664\u4E2D..."),this.api.post("page/infoList/remove_info",e).pipe(p(this.#e),v(()=>{this.$infoList.update(n=>n.filter(r=>r.uid!==e.info.uid)),this.notifyMessage.hide("\u524A\u9664\u3057\u307E\u3057\u305F")}),u(1))}action_remove_info(t){confirm("\u524A\u9664\u306F\u53D6\u308A\u6D88\u305B\u307E\u305B\u3093")&&this.remove_info(t).pipe(p(this.#e),u(1)).subscribe()}info_viewFlag(t){let e={info:V(F({},t),{viewFlag:!t.viewFlag})};return this.notifyMessage.show("\u4FDD\u5B58\u4E2D..."),this.api.post("page/infoList/save_info_viewFlag",e).pipe(p(this.#e),v(()=>{t.viewFlag=e.info.viewFlag,this.changeDetectorRef.markForCheck(),this.notifyMessage.hide("\u4FDD\u5B58\u3057\u307E\u3057\u305F")}),u(1))}action_info_viewFlag(t){this.info_viewFlag(t).pipe(p(this.#e),u(1)).subscribe()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=W({type:i,selectors:[["app-info-list"]],decls:2,vars:1,consts:[[1,"card"],[1,"card-header","p-1"],[1,"card-body","p-1"],[1,"d-flex","flex-column","gap-1"],[1,"card-header","p-0","px-1"],[1,"d-flex","flex-wrap","flex-row","gap-1"],[1,"input-group","input-group-sm","w-auto"],[1,"input-group-text"],["type","text",1,"form-control","form-control-sm",3,"ngModelChange","ngModel"],[1,"form-select","form-select-sm",3,"ngModelChange","ngModel"],[3,"ngValue","textContent"],["type","number",1,"form-control","form-control-sm",2,"width","4rem",3,"ngModelChange","wheel","min","ngModel"],[1,"d-flex","justify-content-between","px-1"],[1,"mx-1","label-count",3,"textContent"],[1,"fa","fa-refresh","fa-hover","cursor-pointer",3,"click"],[1,"table","table-sm","table-bordered","table-striped","table-hover","info-list-table"],[1,"table-warning"],["routerLink","/infoEdit",3,"queryParams","textContent"],[1,"d-flex","flex-row","gap-1","justify-content-center"],[1,"btn","btn-sm","border",3,"click","textContent"],[1,"btn","btn-sm","btn-danger",3,"click"]],template:function(e,n){e&1&&h(0,me,37,10,"div",0)(1,_e,2,0,"div"),e&2&&x(n.$isReady()?0:1)},dependencies:[ae,ie,ne,X,ee,te,Y,oe,Z,z,U],styles:[".info-list-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(2){width:10rem}"]})};export{D as default};
